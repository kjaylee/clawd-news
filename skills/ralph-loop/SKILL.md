---
name: ralph-loop
description: AI 자율 구현 방법론. 구현/개발/코딩 요청 시 자동 적용. 메인은 마더 서브에이전트를 spawn하고, 마더가 워커들을 관리. specs/ → IMPLEMENTATION_PLAN.md → 1태스크씩 구현 → 테스트 → 반복.
---

# Ralph Loop

Geoffrey Huntley의 AI 자율 개발 방법론. 컨텍스트 효율성과 자율성 극대화.

## 핵심 원칙

1. **1태스크 1사이클** - 작게 쪼개서 스마트존 유지
2. **3-tier 에이전트 구조** - 메인 → 마더 → 워커
3. **파일이 메모리** - 상태는 디스크에 기록
4. **백프레셔** - 테스트/린트로 품질 게이트

## 에이전트 구조

```
┌─────────────────────────────────────────────┐
│  메인 에이전트 (Main)                        │
│  • 사용자와 대화                             │
│  • Ralph Loop 마더 spawn                    │
│  • 전체 조율 및 의사결정                      │
└──────────────────┬──────────────────────────┘
                   │ spawn (label: ralph-mother)
                   ▼
┌─────────────────────────────────────────────┐
│  마더 에이전트 (Mother)                      │
│  • specs/ 폴더 생성 및 관리                   │
│  • IMPLEMENTATION_PLAN.md 생성/업데이트       │
│  • 워커 서브에이전트 spawn                    │
│  • 진행 상황 메인에게 보고                    │
└──────────────────┬──────────────────────────┘
                   │ spawn (label: ralph-worker-N)
                   ▼
┌─────────────────────────────────────────────┐
│  워커 에이전트 (Worker)                      │
│  • 단일 태스크 구현                          │
│  • 테스트 실행                               │
│  • 결과 마더에게 보고                        │
└─────────────────────────────────────────────┘
```

## 워크플로우

### 메인 에이전트 역할

사용자가 구현/개발 요청 시:
1. 요구사항 파악 및 명확화
2. **Ralph Loop 마더 서브에이전트 spawn**
3. 마더 보고 수신 및 사용자에게 진행 상황 전달
4. 필요시 의사결정 및 방향 조정

### 마더 에이전트 역할

spawn 시 전달받은 요구사항으로:

**Phase 1: 요구사항 정의**
```
specs/
├── feature-a.md
├── feature-b.md
└── ...
```
- 각 기능별 스펙 문서 작성
- 1 topic = 1 file (and 없이 한 문장으로 설명 가능해야 함)

**Phase 2: 플래닝**
```markdown
# IMPLEMENTATION_PLAN.md
## TODO
- [ ] 태스크 1
- [ ] 태스크 2
## DONE
- [x] 완료된 태스크
```
- specs vs 현재 코드 gap 분석
- 우선순위 정렬된 태스크 리스트

**Phase 3: 빌딩 (반복)**
```
1. IMPLEMENTATION_PLAN.md 읽기
2. 가장 중요한 태스크 선택
3. 워커 서브에이전트 spawn (해당 태스크 할당)
4. 워커 완료 보고 수신
5. 테스트 결과 확인 (백프레셔)
6. 플랜 업데이트
7. 커밋
8. 다음 태스크로 반복 또는 완료 보고
```

### 워커 에이전트 역할

마더로부터 할당받은 단일 태스크:
1. specs 및 관련 코드 분석
2. 구현
3. 테스트 실행
4. 결과를 마더에게 보고 (성공/실패/이슈)

## 서브에이전트 spawn 예시

**메인 → 마더:**
```
label: ralph-mother
task: "[요구사항 요약] 구현. specs/ 작성 → IMPLEMENTATION_PLAN.md → 워커로 구현 → 완료 시 보고"
```

**마더 → 워커:**
```
label: ralph-worker-1
task: "태스크: [구체적 태스크]. specs/xxx.md 참조. 구현 후 테스트 실행, 결과 보고."
```

## 컨텍스트 관리

- **메인**: 최소 컨텍스트 유지 (사용자 대화에 집중)
- **마더**: 전체 플랜과 진행 상황만 트래킹
- **워커**: 단일 태스크에만 집중 (40-60% 스마트존)

## 장점

1. **메인 에이전트 자유로움** - 사용자 응답에 즉시 대응 가능
2. **컨텍스트 격리** - 구현 디테일이 메인을 오염시키지 않음
3. **병렬 작업** - 마더가 여러 워커 관리 가능
4. **명확한 책임** - 각 레벨의 역할이 분명

## 상세 가이드

복잡한 프로젝트는 [references/workflow.md](references/workflow.md) 참조.
