# Color Sort Puzzle - 컬러 소트 퍼즐

## 게임 컨셉
Water Sort Puzzle 스타일의 힐링 퍼즐 게임. 여러 튜브에 섞여있는 색상을 정렬하여 각 튜브를 단일 색상으로 채우는 논리 퍼즐.

## 핵심 메카닉
- **튜브 선택**: 튜브를 탭하여 선택, 다른 튜브 탭하여 이동
- **색상 이동 규칙**:
  - 같은 색상 위에만 부을 수 있음
  - 빈 튜브에는 어떤 색상이든 이동 가능
  - 한 번에 연속된 같은 색상 전체가 이동
  - 튜브 용량(4칸)을 초과할 수 없음
- **클리어 조건**: 모든 튜브가 빈 상태이거나 단일 색상으로 가득 참
- **언두 기능**: 이전 수로 되돌리기 (리워드 광고)

## 타겟 유저
- 캐주얼 게이머 (20-60대)
- 힐링/릴렉스 게임 선호층
- 논리 퍼즐 애호가
- 짧은 시간 킬링용

## 차별점
1. **미니멀 & 힐링 디자인**: 파스텔톤 색상, 부드러운 애니메이션
2. **무한 레벨**: 절차적 생성으로 무한 퍼즐 제공
3. **난이도 곡선**: 점진적 튜브/색상 증가
4. **접근성**: 원터치 조작, 실수해도 언두 가능

## 수익 모델
- **리워드 광고**:
  - 힌트 사용 시 (다음 최적 수 표시)
  - 언두 사용 시 (무제한 되돌리기)
  - 스킵 시 (다음 레벨로)
- **광고 제거 IAP**: $2.99 (모든 기능 무제한)
- **힌트 팩 IAP**: $0.99 (힌트 50개)

## 기술 스택
- HTML5 Canvas
- Vanilla JavaScript (의존성 없음)
- LocalStorage (진행 상황 저장)
- PWA 지원 (오프라인 플레이)

## 시스템 설계

### 게임 상태
```javascript
{
  tubes: [             // 튜브 배열
    [1, 1, 2, 3],      // 각 튜브는 색상 배열 (아래→위)
    [2, 3, 1, 2],
    [3, 2, 3, 1],
    [],                // 빈 튜브
    []
  ],
  level: number,       // 현재 레벨
  moves: number,       // 이동 횟수
  history: [],         // 언두용 히스토리
  selectedTube: null,  // 선택된 튜브 인덱스
  hintsUsed: number,
  undosUsed: number
}
```

### 색상 팔레트 (8색)
```javascript
const COLORS = {
  1: '#FF6B6B',  // 레드
  2: '#4ECDC4',  // 틸
  3: '#FFE66D',  // 옐로우
  4: '#95E1D3',  // 민트
  5: '#F38181',  // 코랄
  6: '#AA96DA',  // 라벤더
  7: '#FCBAD3',  // 핑크
  8: '#A8D8EA'   // 스카이블루
};
```

### 레벨 생성 알고리즘
```javascript
function generateLevel(level) {
  // 난이도 기반 파라미터
  const numColors = Math.min(4 + Math.floor(level / 5), 8);
  const numTubes = numColors + 2;  // 빈 튜브 2개
  const tubeCapacity = 4;
  
  // 1. 완성된 상태 생성 (색상별 튜브)
  // 2. 랜덤 셔플 (역방향 이동)
  // 3. 해결 가능성 검증
  // 4. 최소 이동 수 계산
}
```

### 핵심 함수
```javascript
function canPour(fromTube, toTube) {
  // 이동 가능 여부 체크
}

function pour(fromIndex, toIndex) {
  // 색상 이동 실행
}

function checkWin() {
  // 모든 튜브가 비었거나 단색으로 가득 참
}

function getHint() {
  // BFS로 최적 다음 수 탐색
}
```

## UI/UX 플로우

### 메인 화면
```
┌─────────────────────┐
│                     │
│    🧪 COLOR SORT    │
│                     │
│     Level: 15       │
│                     │
│      [▶ PLAY]       │
│                     │
│    [🎁 NO ADS]      │
│                     │
└─────────────────────┘
```

### 게임 화면
```
┌─────────────────────┐
│ Lv.15    Moves: 12  │
├─────────────────────┤
│                     │
│   ┌┐  ┌┐  ┌┐  ┌┐   │
│   ││  ││  ││  ││   │
│   │🔴││🔵││🟡││  │   │
│   │🔴││🔵││🔴││  │   │
│   │🔵││🟡││🔵││  │   │
│   │🟡││🔴││🟡││  │   │
│   └┘  └┘  └┘  └┘   │
│                     │
├─────────────────────┤
│ [💡Hint] [↩️Undo] [🔄]│
└─────────────────────┘
```

### 승리 화면
```
┌─────────────────────┐
│                     │
│   🎉 COMPLETE! 🎉   │
│                     │
│   Level 15 Clear    │
│   Moves: 12         │
│                     │
│   [▶ Next Level]    │
│   [🏠 Home]         │
│                     │
└─────────────────────┘
```

## 밸런스 파라미터

### 난이도 곡선
| 레벨 | 색상 수 | 튜브 수 | 빈 튜브 | 예상 최소 이동 |
|------|---------|---------|---------|----------------|
| 1-4  | 4       | 6       | 2       | 8-15           |
| 5-9  | 5       | 7       | 2       | 15-25          |
| 10-14| 6       | 8       | 2       | 25-35          |
| 15-19| 7       | 9       | 2       | 35-45          |
| 20+  | 8       | 10      | 2       | 45+            |

### 경제 밸런스
- **무료 힌트**: 레벨당 1회
- **무료 언두**: 무제한 (마지막 3수까지)
- **광고 힌트**: 3회 추가
- **광고 전체 언두**: 레벨 처음부터

### 리텐션 요소
- 일일 챌린지 (보너스 레벨)
- 연속 출석 보상
- 업적 시스템

## 구현 체크리스트
- [x] 기획서 작성
- [x] 프로토타입 구현 (2026-01-28)
- [x] 레벨 생성 로직
- [x] UI/애니메이션
- [ ] 사운드
- [ ] 광고 통합
- [ ] iOS/Android 빌드

## 구현 상태
- [x] 구현 완료 (2026-01-28)

---
*생성일: 2025-01-29*
*기반 트렌드: Water Sort Puzzle, Magic Sort, Screw Sort Puzzle 글로벌 인기*
