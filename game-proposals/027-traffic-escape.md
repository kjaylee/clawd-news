# 027. Traffic Escape - 트래픽 이스케이프

## 게임 컨셉
주차장에 갇힌 자동차를 탈출시키는 슬라이딩 퍼즐 게임. 클래식 "Rush Hour" 보드게임의 디지털 버전으로, 2025-2026년 Parking Jam 3D, Traffic Escape 등이 앱스토어 상위권에 진입하며 증명된 장르.

**핵심 어필**: 한 눈에 규칙을 이해할 수 있지만, 최적 해를 찾기는 어려운 "easy to learn, hard to master" 설계.

## 핵심 메카닉
- **슬라이딩 퍼즐**: 6×6 그리드에서 차량을 앞뒤(가로차) 또는 위아래(세로차)로 슬라이드
- **탈출 목표**: 빨간 주인공 차량을 출구(오른쪽 가장자리)로 이동
- **장애물**: 다른 차량들이 경로를 막음 — 재배치해야 길이 열림
- **레벨 기반**: 150+ 핸드크래프트 퍼즐 + 프로시저럴 레벨 생성
- **별 시스템**: 이동 횟수에 따라 ⭐1~3개 획득

## 타겟 유저
- 캐주얼 퍼즐 게이머 (전 연령)
- 논리/공간 추론 선호자
- 짧은 세션(1-3분) 플레이어

## 차별점
1. **미니멀 + 아이소메트릭 뷰**: 2.5D 느낌의 깔끔한 차량 디자인
2. **완벽한 터치 UX**: 스와이프로 차량 이동, 원터치 조작
3. **프로그레시브 난이도**: 튜토리얼 → 차량 크기 다양화 → 복잡한 퍼즐
4. **리플레이 가치**: 최소 이동 도전, 별 수집
5. **오프라인 완전 지원**: 인터넷 불필요

## 수익 모델
- **보상형 광고**: 힌트 (3수 공개), 레벨 스킵, Undo
- **배너 광고**: 게임 하단 (비침습적)
- **인앱 구매**: 광고 제거 ($2.99), 힌트 팩 (50개 $1.99)
- **예상 eCPM**: $15-25 (퍼즐 장르 프리미엄)

## 기술 스택
- HTML5 Canvas (렌더링)
- Vanilla JavaScript (의존성 0)
- CSS3 전환/애니메이션
- LocalStorage (진행 저장)
- Touch Events API (스와이프 제스처)

---

## 시스템 설계

### 게임 오브젝트
```javascript
Vehicle {
  id: number,
  type: 'car' | 'truck',    // 2칸 vs 3칸
  orientation: 'H' | 'V',    // 가로 vs 세로
  row: number,               // 그리드 행 (0-5)
  col: number,               // 그리드 열 (0-5)
  color: string,             // 차량 색상
  isPlayer: boolean          // true = 탈출 대상 (빨간 차)
}

Level {
  id: number,
  gridSize: 6,
  vehicles: Vehicle[],
  exitRow: number,           // 출구 위치 (보통 2)
  exitSide: 'right',
  minMoves: number,          // 최적 해 이동 수
  difficulty: 'easy' | 'medium' | 'hard' | 'expert'
}

GameState {
  currentLevel: number,
  moves: number,
  moveHistory: Move[],       // Undo 지원
  stars: { [levelId]: number },
  totalStars: number,
  hintsRemaining: number,
  coins: number
}
```

### 이동 로직
```javascript
canMove(vehicle, direction, distance) {
  // 1. 방향 유효성: H차량은 좌/우만, V차량은 상/하만
  // 2. 경로 상 다른 차량 충돌 체크
  // 3. 그리드 범위 체크
  // 4. 이동 가능 시 true + 최대 이동 거리 반환
}

checkWin() {
  // 플레이어 차량이 출구에 도달했는지 확인
  // playerCar.col + playerCar.length >= gridSize
}
```

### 레벨 데이터 (내장 150+)
```javascript
const LEVELS = [
  // Level 1 (Tutorial - 1 move)
  {
    id: 1, difficulty: 'easy', minMoves: 1,
    vehicles: [
      { type: 'car', orientation: 'H', row: 2, col: 3, isPlayer: true },
      // 장애물 없음 — 바로 출구
    ]
  },
  // Level 2 (Easy - 3 moves)
  {
    id: 2, difficulty: 'easy', minMoves: 3,
    vehicles: [
      { type: 'car', orientation: 'H', row: 2, col: 0, isPlayer: true },
      { type: 'truck', orientation: 'V', row: 0, col: 3, isPlayer: false },
    ]
  },
  // ... 점진적 난이도 증가
];
```

### 힌트 시스템
- BFS 기반 최적 해 탐색 (상태 공간 검색)
- 힌트 사용 시: 다음 최적 이동 3수 하이라이트
- 비용: 코인 50개 또는 광고 시청

---

## UI/UX 플로우

### 메인 화면
```
┌──────────────────────┐
│   🚗 Traffic Escape  │
│                      │
│      [▶ PLAY]        │
│    [📋 Levels]       │
│                      │
│   ⭐ 234 / 450      │
│   Level 78           │
└──────────────────────┘
```

### 게임 화면
```
┌──────────────────────┐
│ Lv.12  ↩️ 💡  ⚙️     │
│ Moves: 5            │
├──────────────────────┤
│ ┌──┬──┬──┬──┬──┬──┐ │
│ │  │  │🟦│  │  │  │ │
│ ├──┼──┼──┼──┼──┼──┤ │
│ │  │🟩│🟦│  │  │  │ │
│ ├──┼──┼──┼──┼──┼──┤→EXIT
│ │🔴│🔴│  │🟨│🟨│🟨│ │
│ ├──┼──┼──┼──┼──┼──┤ │
│ │  │  │  │🟪│  │  │ │
│ ├──┼──┼──┼──┼──┼──┤ │
│ │  │🟧│🟧│🟪│  │  │ │
│ ├──┼──┼──┼──┼──┼──┤ │
│ │  │  │  │  │  │  │ │
│ └──┴──┴──┴──┴──┴──┘ │
├──────────────────────┤
│   Moves: 5/8 ⭐⭐⭐   │
└──────────────────────┘
```

### 클리어 화면
```
┌──────────────────────┐
│     🎉 CLEAR!       │
│                      │
│    ⭐⭐⭐             │
│    5 moves (best: 4) │
│                      │
│  [▶ Next] [🔄 Retry] │
│  [📋 Levels]         │
└──────────────────────┘
```

### 레벨 선택
```
┌──────────────────────┐
│   📋 Levels          │
│                      │
│  [1⭐⭐⭐][2⭐⭐⭐]     │
│  [3⭐⭐☆][4⭐☆☆]     │
│  [5 🔒 ][6 🔒 ]     │
│  ...                 │
└──────────────────────┘
```

### 인터랙션 디테일
1. **차량 탭/드래그**: 선택 → 이동 방향으로 스와이프
2. **이동 애니메이션**: 200ms ease-out 슬라이드
3. **충돌 피드백**: 빨간 플래시 + 미세 진동
4. **클리어 시**: 빨간 차 우측으로 슝~ 달려나감 + 파티클
5. **별 획득**: 순차적 ⭐ 점등 + 사운드

---

## 밸런스 파라미터

| 구간 | 레벨 | 차량 수 | 최적해 | ⭐⭐⭐ 기준 |
|------|------|---------|--------|-----------|
| 튜토리얼 | 1-5 | 2-3 | 1-3수 | 최적+1 |
| Easy | 6-30 | 3-5 | 4-8수 | 최적+2 |
| Medium | 31-70 | 5-7 | 8-15수 | 최적+3 |
| Hard | 71-120 | 7-9 | 15-25수 | 최적+4 |
| Expert | 121-150 | 9-12 | 25-40수 | 최적+5 |

### 보상 구조
- 레벨 클리어: +10 코인
- ⭐3 클리어: +30 코인 보너스
- 힌트 비용: 50 코인 또는 광고
- Undo: 무료 (무제한)
- 레벨 스킵: 광고 시청

### 차량 타입
| 타입 | 크기 | 색상 | 비고 |
|------|------|------|------|
| 플레이어 | 2칸 | 빨강 | 항상 가로, 출구 행 |
| Car | 2칸 | 다양 | 가로 또는 세로 |
| Truck | 3칸 | 다양 | 가로 또는 세로 |

---

## 구현 우선순위
1. 6×6 그리드 렌더링 + 차량 표시
2. 터치/스와이프 차량 이동
3. 충돌 감지 + 이동 제한
4. 승리 조건 판정
5. 레벨 데이터 30개+ 내장
6. 별 시스템 + 진행 저장
7. Undo 시스템
8. 힌트 시스템 (BFS 솔버)
9. 레벨 선택 UI
10. 프로시저럴 레벨 생성

---
*Created: 2026-01-30 | Status: 미구현 | Trend: Parking Jam 3D/Traffic Escape 장르 인기, 슬라이딩 퍼즐 부활, 하이브리드 캐주얼*
