# spec-ui.md — UI 화면별 설계

## 0. 공통 규칙

- **해상도**: 동적 — `get_viewport_rect().size` 사용 (하드코딩 금지)
- **방향**: 세로 (Portrait)
- **폰트**: NotoSansCJK (한국어) — Godot SystemFont fallback
- **색상 팔레트**:
  - 배경: #1A1A2E (어두운 남색)
  - 패널: #16213E (진한 파랑)
  - 강조: #E94560 (붉은 강조)
  - 텍스트: #FFFFFF (흰색)
  - 보조텍스트: #A0A0A0 (회색)
  - 골드: #FFD700
- **GDScript 규칙**: `var x: Type = value` (`:=` 금지)
- **Safe Area**: 상하 여백 대응

## 1. 타이틀 화면 (Title Screen)

### 레이아웃
```
┌──────────────────────────┐
│                          │
│    삼국지 패왕전          │
│    Three Kingdoms:       │
│    Conqueror             │
│                          │
│    [로고/일러스트]        │
│                          │
│                          │
│   ▶ [새 게임]            │
│   ▶ [이어하기]           │
│   ▶ [설정]              │
│                          │
│   v0.1.0  East Sea Games │
└──────────────────────────┘
```

### 구현 상세
- 배경: 그라디언트 (#1A1A2E → #0F3460)
- 타이틀: 큰 폰트 (48px), 금색 (#FFD700), 그림자
- 버튼: StyleBoxFlat, 라운드 8px, 호버 애니메이션
- 이어하기: 저장 파일 있을 때만 활성화

## 2. 메인 메뉴 (Home)

### 레이아웃
```
┌──────────────────────────┐
│ Lv.1 유비군  💎0  🪙500  │
├──────────────────────────┤
│                          │
│   [메인 장수 일러스트]    │
│                          │
│                          │
├──────────────────────────┤
│                          │
│  [출전]  [장수]  [설정]   │
│   ⚔️     👤     ⚙️      │
│                          │
└──────────────────────────┘
```

### 구현 상세
- 상단 HUD: 레벨, 보석, 골드 상시 표시
- 하단 네비게이션: 3개 버튼 (MVP)
- 중앙: 리더 장수 표시 (이름 + 레벨)

## 3. 장수 목록 (General List)

### 레이아웃
```
┌──────────────────────────┐
│ ← 장수 목록    정렬 [▼]  │
├──────────────────────────┤
│ [전체] [위] [촉] [오]    │
├──────────────────────────┤
│ ┌────┐ ┌────┐ ┌────┐    │
│ │유비│ │관우│ │장비│    │
│ │R   │ │R   │ │R   │    │
│ │Lv.5│ │Lv.3│ │Lv.3│    │
│ └────┘ └────┘ └────┘    │
│                          │
│ (스크롤 가능)            │
└──────────────────────────┘
```

### 구현 상세
- GridContainer: 3열
- 장수 카드: PanelContainer + VBoxContainer
  - 등급 색상 테두리
  - 이름 (한글)
  - 등급 레이블
  - 레벨
- 탭 → 장수 상세로 이동

## 4. 장수 상세 (General Detail)

### 레이아웃
```
┌──────────────────────────┐
│ ← 장수 상세              │
├──────────────────────────┤
│    관우 (關羽)            │
│    ★★★ R  기병/전사      │
│    Lv. 3/40              │
├──────────────────────────┤
│ 무력: ████████████░ 97   │
│ 지력: █████████░░░░ 80   │
│ 통솔: ██████████░░░ 85   │
│ 속도: █████████░░░░ 78   │
│ HP:   4,750              │
├──────────────────────────┤
│ 스킬:                    │
│ 🔴 청룡참월 [액티브]     │
│ 적 1명 무력×5.0 데미지   │
│ 쿨타임: 3턴              │
├──────────────────────────┤
│    [편성에 추가]          │
└──────────────────────────┘
```

### 구현 상세
- 스탯 바: ProgressBar (컬러 = 등급색)
- 스킬 패널: PanelContainer
- HP: calc_max_hp(cmd, level) 계산 표시

## 5. 전투 화면 (Battle Scene) — 핵심

### 레이아웃
```
┌──────────────────────────┐
│ 턴: 1/20  [자동OFF] [x1] │
├──────────────────────────┤
│ [보스 HP바 — 보스전에만]  │
│                          │
│   [적1] [적2] [적3]      │  ← 전열
│      [적4] [적5]         │  ← 후열
│                          │
│      [아4] [아5]         │  ← 후열
│   [아1] [아2] [아3]      │  ← 전열
│                          │
├──────────────────────────┤
│ ▶ 관우  HP:████░ 85%     │
│                          │
│ [일반공격] [청룡참월] [방어]│
│           CD:0           │
└──────────────────────────┘
```

### 유닛 표시
- 각 유닛: ColorRect(64×64) + Label(이름) + ProgressBar(HP)
- 선택된 유닛: 밝은 테두리 + 깜빡임
- 사망 유닛: 투명도 50% + X 마크
- 타겟 유닛: 노란 테두리

### 데미지 팝업
- Label: 숫자 표시
- Tween: 위로 이동(0.5초) + 페이드아웃
- 치명타: 큰 글씨(1.5배) + 노란색(#FFD700)
- 유리상성: 초록색(#4CAF50), 불리: 빨간색(#F44336)

### 행동 UI
- 현재 차례 유닛 정보 표시
- 3개 버튼: 일반공격, 스킬(이름표시), 방어
- 스킬 쿨타임 표시 (CD:N)
- 버튼 선택 후 → 타겟 선택 모드 (적 유닛 탭)

## 6. 전투 결과 (Battle Result)

### 승리
```
┌──────────────────────────┐
│                          │
│      ★ 승 리 ★           │
│                          │
│  획득 보상:              │
│  🪙 골드: 500            │
│  👤 장수: 관우(R)        │
│  📦 경험치: +120         │
│                          │
│       [확인]             │
└──────────────────────────┘
```

### 패배
```
┌──────────────────────────┐
│                          │
│      ✗ 패 배 ✗           │
│                          │
│  "장수를 강화하고         │
│   다시 도전하세요"        │
│                          │
│  [재도전]  [돌아가기]     │
└──────────────────────────┘
```

## 7. 컷씬 화면 (Cutscene)

### 레이아웃
```
┌──────────────────────────┐
│                          │
│  [배경 이미지/그라디언트]  │
│                          │
│                          │
│                          │
│                          │
├──────────────────────────┤
│ [화자 이름]              │
│ "대사 텍스트가 여기에     │
│  한 글자씩 표시됩니다."   │
│              [탭하여 진행] │
└──────────────────────────┘
```

### 구현 상세
- 대사: 타이핑 효과 (RichTextLabel + Timer, 0.03초/글자)
- 탭 시: 전체 표시 → 다시 탭 → 다음 대사
- 감정별 배경색/효과 적용 (spec-campaign.md 참조)
- [스킵] 버튼: 우상단

## 8. 설정 화면 (Settings)

### 레이아웃
```
┌──────────────────────────┐
│ ← 설정                  │
├──────────────────────────┤
│ 🔊 BGM      ████░ 80%   │
│ 🔊 효과음   ██████ 60%  │
│                          │
│ 💾 [저장]    [불러오기]   │
│                          │
│ ℹ️ v0.1.0               │
│    East Sea Games        │
└──────────────────────────┘
```

## 9. 씬 트리 구조 (MVP)

```
scenes/
├── title_screen.tscn        # 타이틀
├── main_menu.tscn           # 메인 메뉴
├── general_list.tscn        # 장수 목록
├── general_detail.tscn      # 장수 상세
├── chapter_select.tscn      # 챕터 선택
├── stage_select.tscn        # 스테이지 선택
├── battle_scene.tscn        # 전투 메인
├── battle_result.tscn       # 전투 결과
├── cutscene.tscn            # 컷씬
└── settings.tscn            # 설정
```

## 10. 씬 전환

```
title_screen → [새게임] → cutscene(인트로) → main_menu
             → [이어하기] → main_menu

main_menu → [출전] → chapter_select → stage_select → battle_scene → battle_result → stage_select
          → [장수] → general_list → general_detail
          → [설정] → settings
```

## 11. 공통 컴포넌트

### HUD (상단 바)
- 레벨, 골드, 보석 표시
- 모든 메뉴 화면에 표시

### 버튼 스타일
```gdscript
# 공통 버튼 스타일
var btn_style: StyleBoxFlat = StyleBoxFlat.new()
btn_style.bg_color = Color(0.91, 0.27, 0.38)  # #E94560
btn_style.corner_radius_top_left = 8
btn_style.corner_radius_top_right = 8
btn_style.corner_radius_bottom_left = 8
btn_style.corner_radius_bottom_right = 8
```
