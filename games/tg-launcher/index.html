<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <title>ğŸ® East Sea Games</title>
    <!-- Telegram Mini App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="/games/tg-sdk-wrapper.js?v=1769733061"></script>
    <style>
        :root {
            --safe-top: env(safe-area-inset-top, 0px);
            --safe-bottom: env(safe-area-inset-bottom, 0px);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, 'Segoe UI', system-ui, sans-serif;
            background: var(--tg-bg, #0f0f1a);
            color: var(--tg-text, #ffffff);
            min-height: var(--tg-viewport-height, 100vh);
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
        }

        /* â”€â”€ Header â”€â”€ */
        .header {
            padding: calc(12px + var(--safe-top, 0px)) 20px 12px;
            background: linear-gradient(180deg, rgba(0,0,0,0.4) 0%, transparent 100%);
        }
        .header-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .user-avatar {
            width: 36px; height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--tg-button, #3390ec), #6c5ce7);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: 700;
        }
        .user-name {
            font-size: 15px;
            font-weight: 600;
        }
        .user-greeting {
            font-size: 12px;
            color: var(--tg-hint, #888);
        }
        .header-action {
            display: flex; gap: 8px;
        }
        .icon-btn {
            width: 36px; height: 36px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            border: none;
            color: var(--tg-text, #fff);
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.15s;
        }
        .icon-btn:active { transform: scale(0.9); }

        /* â”€â”€ Search â”€â”€ */
        .search-bar {
            position: relative;
            margin: 0 20px 16px;
        }
        .search-bar input {
            width: 100%;
            padding: 12px 16px 12px 40px;
            border-radius: 14px;
            border: 1px solid rgba(255,255,255,0.1);
            background: var(--tg-secondary-bg, rgba(255,255,255,0.08));
            color: var(--tg-text, #fff);
            font-size: 15px;
            outline: none;
            transition: border-color 0.2s;
        }
        .search-bar input::placeholder {
            color: var(--tg-hint, #666);
        }
        .search-bar input:focus {
            border-color: var(--tg-button, #3390ec);
        }
        .search-icon {
            position: absolute;
            left: 14px; top: 50%;
            transform: translateY(-50%);
            font-size: 16px;
            opacity: 0.5;
        }

        /* â”€â”€ Categories â”€â”€ */
        .categories {
            display: flex;
            gap: 8px;
            padding: 0 20px;
            overflow-x: auto;
            scrollbar-width: none;
            -webkit-overflow-scrolling: touch;
            margin-bottom: 20px;
        }
        .categories::-webkit-scrollbar { display: none; }
        .cat-chip {
            padding: 8px 16px;
            border-radius: 20px;
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.08);
            color: var(--tg-hint, #aaa);
            font-size: 13px;
            font-weight: 500;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.2s;
            min-height: 36px;
            display: flex;
            align-items: center;
        }
        .cat-chip.active {
            background: var(--tg-button, #3390ec);
            color: var(--tg-button-text, #fff);
            border-color: var(--tg-button, #3390ec);
        }
        .cat-chip:active { transform: scale(0.95); }

        /* â”€â”€ Section â”€â”€ */
        .section {
            margin-bottom: 24px;
        }
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            margin-bottom: 12px;
        }
        .section-title {
            font-size: 18px;
            font-weight: 700;
        }
        .section-more {
            font-size: 13px;
            color: var(--tg-link, #4ea8ff);
            cursor: pointer;
        }

        /* â”€â”€ Featured (horizontal scroll) â”€â”€ */
        .featured-scroll {
            display: flex;
            gap: 12px;
            padding: 0 20px;
            overflow-x: auto;
            scrollbar-width: none;
            -webkit-overflow-scrolling: touch;
        }
        .featured-scroll::-webkit-scrollbar { display: none; }
        .featured-card {
            flex: 0 0 240px;
            border-radius: 16px;
            overflow: hidden;
            background: var(--tg-secondary-bg, #16213e);
            cursor: pointer;
            transition: transform 0.15s;
            border: 1px solid rgba(255,255,255,0.06);
        }
        .featured-card:active { transform: scale(0.97); }
        .featured-banner {
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            position: relative;
        }
        .featured-rank {
            position: absolute;
            top: 8px; left: 8px;
            background: rgba(0,0,0,0.6);
            padding: 2px 8px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 700;
        }
        .featured-info {
            padding: 10px 14px;
        }
        .featured-name {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 2px;
        }
        .featured-desc {
            font-size: 12px;
            color: var(--tg-hint, #888);
        }
        .featured-play {
            margin-top: 8px;
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 10px;
            background: var(--tg-button, #3390ec);
            color: var(--tg-button-text, #fff);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            min-height: 44px;
            transition: opacity 0.15s;
        }
        .featured-play:active { opacity: 0.8; }

        /* â”€â”€ Game Grid â”€â”€ */
        .game-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 12px;
            padding: 0 20px;
        }
        .game-card {
            border-radius: 14px;
            background: var(--tg-secondary-bg, #16213e);
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.15s;
            border: 1px solid rgba(255,255,255,0.06);
        }
        .game-card:active { transform: scale(0.96); }
        .game-icon {
            height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
        }
        .game-meta {
            padding: 8px 10px 10px;
        }
        .game-name {
            font-size: 13px;
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .game-genre {
            font-size: 11px;
            color: var(--tg-hint, #888);
            margin-top: 2px;
        }

        /* â”€â”€ Footer â”€â”€ */
        .footer {
            text-align: center;
            padding: 20px 20px calc(20px + var(--safe-bottom));
            color: var(--tg-hint, #555);
            font-size: 12px;
        }
        .footer a {
            color: var(--tg-link, #4ea8ff);
            text-decoration: none;
        }

        /* â”€â”€ Loading â”€â”€ */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 200px;
            font-size: 32px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* â”€â”€ Gradients for featured cards â”€â”€ */
        .grad-1 { background: linear-gradient(135deg, #e94560, #f39c12); }
        .grad-2 { background: linear-gradient(135deg, #6c5ce7, #a29bfe); }
        .grad-3 { background: linear-gradient(135deg, #00b894, #00cec9); }
        .grad-4 { background: linear-gradient(135deg, #fd79a8, #e84393); }
        .grad-5 { background: linear-gradient(135deg, #0984e3, #74b9ff); }

        /* â”€â”€ No results â”€â”€ */
        .no-results {
            text-align: center;
            padding: 40px 20px;
            color: var(--tg-hint, #888);
        }
        .no-results .emoji { font-size: 48px; margin-bottom: 12px; }
    </style>
</head>
<body>

<!-- Header -->
<div class="header">
    <div class="header-top">
        <div class="user-info">
            <div class="user-avatar" id="userAvatar">ğŸ®</div>
            <div>
                <div class="user-name" id="userName">Player</div>
                <div class="user-greeting" id="userGreeting">ê²Œì„ì„ ê³¨ë¼ë³´ì„¸ìš”!</div>
            </div>
        </div>
        <div class="header-action">
            <button class="icon-btn" onclick="TG.shareInvite()" title="Invite">ğŸ‘¥</button>
        </div>
    </div>
</div>

<!-- Search -->
<div class="search-bar">
    <span class="search-icon">ğŸ”</span>
    <input type="text" id="searchInput" placeholder="ê²Œì„ ê²€ìƒ‰...">
</div>

<!-- Categories -->
<div class="categories" id="categories"></div>

<!-- Featured Games -->
<div class="section" id="featuredSection">
    <div class="section-header">
        <span class="section-title">ğŸ† TOP 5 ì¸ê¸° ê²Œì„</span>
    </div>
    <div class="featured-scroll" id="featuredGames"></div>
</div>

<!-- All Games -->
<div class="section" id="allGamesSection">
    <div class="section-header">
        <span class="section-title" id="allGamesTitle">ğŸ® ì „ì²´ ê²Œì„</span>
        <span class="section-more" id="gameCount"></span>
    </div>
    <div class="game-grid" id="gameGrid"></div>
</div>

<!-- Footer -->
<div class="footer">
    Made with â¤ï¸ by <a href="https://eastsea.monster">East Sea Games</a><br>
    <span style="font-size:11px">46 Free HTML5 Games</span>
</div>

<script>
'use strict';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ê²Œì„ ë°ì´í„°
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const GAMES = [
    // TOP 5
    { id: 'crystal-match', name: 'Crystal Match', emoji: 'ğŸ’', genre: 'ë§¤ì¹˜3', genreEn: 'Match-3', cat: 'puzzle', top: true, grad: 'grad-2' },
    { id: 'sushi-sprint', name: 'Sushi Sprint', emoji: 'ğŸ£', genre: 'íƒ€ì„ë§¤ë‹ˆì§€ë¨¼íŠ¸', genreEn: 'Time Mgmt', cat: 'sim', top: false, grad: 'grad-2' },
    { id: 'ball-sort', name: 'Ball Sort Puzzle', emoji: 'ğŸ”®', genre: 'ë¶„ë¥˜ í¼ì¦', genreEn: 'Sort Puzzle', cat: 'puzzle', top: true, grad: 'grad-3' },
    { id: 'idle-slime-merge', name: 'Idle Slime Merge', emoji: 'ğŸ«§', genre: 'ì•„ì´ë“¤/ë¨¸ì§€', genreEn: 'Idle', cat: 'idle', top: true, grad: 'grad-5' },
    { id: 'neon-snake', name: 'Neon Snake', emoji: 'ğŸ', genre: 'ì•„ì¼€ì´ë“œ', genreEn: 'Arcade', cat: 'action', top: true, grad: 'grad-1' },
    { id: 'fruit-merge-drop', name: 'Fruit Merge', emoji: 'ğŸ‰', genre: 'ë¨¸ì§€', genreEn: 'Merge', cat: 'idle', top: true, grad: 'grad-4' },
    // Puzzle
    { id: 'chain-pop', name: 'Chain Pop', emoji: 'ğŸ’¥', genre: 'í¼ì¦', genreEn: 'Puzzle', cat: 'puzzle' },
    { id: 'hex-drop', name: 'Hex Drop', emoji: 'â¬¡', genre: 'í¼ì¦', genreEn: 'Puzzle', cat: 'puzzle' },
    { id: 'laser-reflect', name: 'Laser Reflect', emoji: 'ğŸ”¦', genre: 'í¼ì¦', genreEn: 'Puzzle', cat: 'puzzle' },
    { id: 'number-drop', name: 'Number Drop', emoji: 'ğŸ”¢', genre: 'í¼ì¦', genreEn: 'Puzzle', cat: 'puzzle' },
    { id: 'pipe-connect', name: 'Pipe Connect', emoji: 'ğŸ”§', genre: 'í¼ì¦', genreEn: 'Puzzle', cat: 'puzzle' },
    { id: 'rope-untangle', name: 'Rope Untangle', emoji: 'ğŸª¢', genre: 'í¼ì¦', genreEn: 'Puzzle', cat: 'puzzle' },
    // Match
    { id: 'mahjong-zen', name: 'Mahjong Zen', emoji: 'ğŸ€„', genre: 'ë§ˆì‘', genreEn: 'Mahjong', cat: 'puzzle' },
    // Arcade
    { id: 'block-bounce', name: 'Block Bounce', emoji: 'ğŸŸ«', genre: 'ì•„ì¼€ì´ë“œ', genreEn: 'Arcade', cat: 'action' },
    { id: 'block-fit', name: 'Block Fit Zen', emoji: 'ğŸ§©', genre: 'í¼ì¦', genreEn: 'Puzzle', cat: 'puzzle' },
    { id: 'brick-breaker', name: 'Brick Breaker', emoji: 'ğŸ§±', genre: 'ì•„ì¼€ì´ë“œ', genreEn: 'Arcade', cat: 'action' },
    { id: 'gravity-orbit', name: 'Gravity Orbit', emoji: 'ğŸŒ', genre: 'ì•„ì¼€ì´ë“œ', genreEn: 'Arcade', cat: 'action' },
    { id: 'hole-swallow', name: 'Hole Swallow', emoji: 'ğŸ•³ï¸', genre: 'ì•„ì¼€ì´ë“œ', genreEn: 'Arcade', cat: 'action' },
    { id: 'infinite-stack-climb', name: 'Stack Climb', emoji: 'ğŸ—ï¸', genre: 'ì•„ì¼€ì´ë“œ', genreEn: 'Arcade', cat: 'action' },
    { id: 'orbit-striker', name: 'Orbit Striker', emoji: 'ğŸ¯', genre: 'ì•„ì¼€ì´ë“œ', genreEn: 'Arcade', cat: 'action' },
    { id: 'single-tap-golf', name: 'Tap Golf', emoji: 'â›³', genre: 'ìŠ¤í¬ì¸ ', genreEn: 'Sports', cat: 'action' },
    { id: 'jump-physics', name: 'Jump Physics', emoji: 'ğŸ¦˜', genre: 'ë¬¼ë¦¬', genreEn: 'Physics', cat: 'action' },
    // Puzzle - ì¶”ê°€
    { id: 'power-2048', name: 'Power 2048', emoji: 'âš¡', genre: 'í¼ì¦', genreEn: 'Puzzle', cat: 'puzzle' },
    // Strategy
    { id: 'bubble-defense', name: 'Bubble Defense', emoji: 'ğŸ«§', genre: 'ë””íœìŠ¤', genreEn: 'Defense', cat: 'strategy' },
    { id: 'pixel-defense', name: 'Pixel Defense', emoji: 'ğŸ‘¾', genre: 'ë””íœìŠ¤', genreEn: 'Defense', cat: 'strategy' },
    // RPG
    { id: 'dungeon-run', name: 'Dungeon Run', emoji: 'ğŸƒ', genre: 'RPG ëŸ°', genreEn: 'RPG', cat: 'rpg' },
    { id: 'polygon-dungeon', name: 'Polygon Dungeon', emoji: 'âš”ï¸', genre: 'RPG', genreEn: 'RPG', cat: 'rpg' },
    { id: 'zombie-survivor', name: 'Zombie Survivor', emoji: 'ğŸ§Ÿ', genre: 'ì„œë°”ì´ë²Œ', genreEn: 'Survival', cat: 'rpg' },
    { id: 'spot-the-odd', name: 'Spot the Odd', emoji: 'ğŸ‘ï¸', genre: 'ê´€ì°° í¼ì¦', genreEn: 'Observation', cat: 'puzzle' },
{ id: 'puzzle-rogue', name: 'Puzzle Rogue Dungeon', emoji: 'âš”ï¸', genre: 'RPG/í¼ì¦', genreEn: 'RPG', cat: 'rpg' },
    { id: 'screw-sort', name: 'Screw Sort Factory', emoji: 'ğŸ”©', genre: 'í¼ì¦/ì •ë ¬', genreEn: 'Puzzle', cat: 'puzzle' },
    { id: 'tap-away', name: 'Tap Away Puzzle', emoji: 'ğŸ§Š', genre: 'í¼ì¦/ë¡œì§', genreEn: 'Logic', cat: 'puzzle' },
    { id: 'slime-survivor-premium', name: 'Slime Premium', emoji: 'ğŸŸ¢', genre: 'ì„œë°”ì´ë²Œ PRO', genreEn: 'Survival+', cat: 'rpg' },
    { id: 'three-kingdoms', name: 'ì‚¼êµ­ì§€ íŒ¨ì™•ì „', emoji: 'âš”ï¸', genre: 'ì „ëµ RPG', genreEn: 'Strategy RPG', cat: 'rpg' },
    { id: 'gem-cascade', name: 'Gem Cascade', emoji: 'ğŸ’', genre: 'ë§¤ì¹˜ í¼ì¦', genreEn: 'Match Puzzle', cat: 'puzzle' },
    // Casual
    { id: 'dice-master', name: 'Dice Master', emoji: 'ğŸ²', genre: 'ìºì£¼ì–¼', genreEn: 'Casual', cat: 'casual' },
    { id: 'fishing-tycoon', name: 'Fishing Tycoon', emoji: 'ğŸ£', genre: 'íƒ€ì´ì¿¤', genreEn: 'Tycoon', cat: 'casual' },
    { id: 'micro-factory', name: 'Micro Factory', emoji: 'âš™ï¸', genre: 'ê²½ì˜', genreEn: 'Tycoon', cat: 'casual' },
    { id: 'pet-simulator', name: 'Pet Simulator', emoji: 'ğŸ¶', genre: 'ì‹œë®¬ë ˆì´ì…˜', genreEn: 'Sim', cat: 'casual' },
    // Rhythm
    { id: 'rhythm-pulse', name: 'Rhythm Pulse', emoji: 'ğŸµ', genre: 'ë¦¬ë“¬', genreEn: 'Rhythm', cat: 'action' },
    // Factory
    { id: 'conveyor-sort', name: 'Conveyor Sort', emoji: 'ğŸ­', genre: 'íŒ©í† ë¦¬', genreEn: 'Factory', cat: 'puzzle' },
    { id: 'traffic-escape', name: 'Traffic Escape', emoji: 'ğŸš—', genre: 'êµí†µ í¼ì¦', genreEn: 'Traffic', cat: 'puzzle' },
    // Word
    { id: 'word-chain-blast', name: 'Word Chain Blast', emoji: 'ğŸ”¤', genre: 'ì›Œë“œ í¼ì¦', genreEn: 'Word Puzzle', cat: 'puzzle' },
{ id: 'merge-bloom', name: 'Merge Bloom Garden', emoji: 'ğŸŒ¸', genre: 'ë¨¸ì§€ í¼ì¦', genreEn: 'Merge Puzzle', cat: 'puzzle' },
{ id: 'slide-block-match', name: 'Slide Block Match', emoji: 'ğŸŸ¦', genre: 'ìŠ¬ë¼ì´ë“œ í¼ì¦', genreEn: 'Slide Puzzle', cat: 'puzzle' },
{ id: 'color-slide-jam', name: 'Color Slide Jam', emoji: 'ğŸ¨', genre: 'ì»¬ëŸ¬ í¼ì¦', genreEn: 'Color Puzzle', cat: 'puzzle' },
{ id: 'stack-tower', name: 'Stack Tower', emoji: 'ğŸ—ï¸', genre: 'ë¸”ë¡ ìŒ“ê¸°', genreEn: 'Stacking', cat: 'casual' },
{ id: 'match-3d-zen', name: 'Match 3D Zen', emoji: 'ğŸ§Š', genre: '3D ë§¤ì¹­', genreEn: 'Matching', cat: 'puzzle' },
{ id: 'paint-flood', name: 'Paint Flood', emoji: 'ğŸ¨', genre: 'í¼ì¦/í”ŒëŸ¬ë“œ', genreEn: 'Puzzle', cat: 'puzzle' },
{ id: 'glow-grid', name: 'Glow Grid', emoji: 'âœ¨', genre: 'ë„¤ì˜¨ í¼ì¦', genreEn: 'Neon Puzzle', cat: 'puzzle' },
];

const CATEGORIES = [
    { id: 'all', name: 'ì „ì²´', nameEn: 'All', emoji: 'ğŸ®' },
    { id: 'top', name: 'TOP 5', nameEn: 'TOP 5', emoji: 'ğŸ†' },
    { id: 'puzzle', name: 'í¼ì¦', nameEn: 'Puzzle', emoji: 'ğŸ§©' },
    { id: 'action', name: 'ì•¡ì…˜', nameEn: 'Action', emoji: 'âš¡' },
    { id: 'idle', name: 'ì•„ì´ë“¤', nameEn: 'Idle', emoji: 'ğŸ«§' },
    { id: 'strategy', name: 'ì „ëµ', nameEn: 'Strategy', emoji: 'ğŸ°' },
    { id: 'rpg', name: 'RPG', nameEn: 'RPG', emoji: 'âš”ï¸' },
    { id: 'casual', name: 'ìºì£¼ì–¼', nameEn: 'Casual', emoji: 'ğŸ²' },
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì•± ìƒíƒœ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentCat = 'all';
let searchQuery = '';
const isKo = (TG.getLang?.() || navigator.language || 'en').startsWith('ko');

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì´ˆê¸°í™”
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initApp() {
    setupUser();
    renderCategories();
    renderFeatured();
    renderAllGames();
    setupSearch();

    // TG Back â†’ ì•± ë‹«ê¸°
    if (TG.isTelegram()) {
        TG.onBack(() => {
            if (searchQuery) {
                document.getElementById('searchInput').value = '';
                searchQuery = '';
                renderAllGames();
                return true;
            }
            return false; // close app
        });
    }
}

function setupUser() {
    const name = TG.getUserName?.() || 'Player';
    const initial = name.charAt(0).toUpperCase();
    document.getElementById('userName').textContent = name;
    document.getElementById('userAvatar').textContent = initial;
    
    const hour = new Date().getHours();
    let greeting;
    if (isKo) {
        greeting = hour < 12 ? 'ì¢‹ì€ ì•„ì¹¨ì´ì—ìš”! â˜€ï¸' : hour < 18 ? 'ì¦ê±°ìš´ ì˜¤í›„! ğŸ®' : 'ì¢‹ì€ ë°¤ì´ì—ìš”! ğŸŒ™';
    } else {
        greeting = hour < 12 ? 'Good morning! â˜€ï¸' : hour < 18 ? 'Good afternoon! ğŸ®' : 'Good evening! ğŸŒ™';
    }
    document.getElementById('userGreeting').textContent = greeting;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì¹´í…Œê³ ë¦¬ ë Œë”ë§
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderCategories() {
    const el = document.getElementById('categories');
    el.innerHTML = CATEGORIES.map(c => 
        `<div class="cat-chip ${c.id === currentCat ? 'active' : ''}" data-cat="${c.id}">
            ${c.emoji} ${isKo ? c.name : c.nameEn}
        </div>`
    ).join('');

    el.addEventListener('click', (e) => {
        const chip = e.target.closest('.cat-chip');
        if (!chip) return;
        TG.haptic?.('selection');
        currentCat = chip.dataset.cat;
        el.querySelectorAll('.cat-chip').forEach(c => c.classList.toggle('active', c.dataset.cat === currentCat));
        renderAllGames();

        // Show/hide featured
        document.getElementById('featuredSection').style.display =
            (currentCat === 'all' || currentCat === 'top') ? '' : 'none';
    });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Featured ë Œë”ë§
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderFeatured() {
    const el = document.getElementById('featuredGames');
    const topGames = GAMES.filter(g => g.top);
    
    el.innerHTML = topGames.map((g, i) => `
        <div class="featured-card" data-game="${g.id}">
            <div class="featured-banner ${g.grad}">
                <span class="featured-rank">#${i+1}</span>
                <span style="font-size:48px">${g.emoji}</span>
            </div>
            <div class="featured-info">
                <div class="featured-name">${g.name}</div>
                <div class="featured-desc">${isKo ? g.genre : g.genreEn}</div>
                <button class="featured-play">${isKo ? 'í”Œë ˆì´' : 'Play'} â–¶</button>
            </div>
        </div>
    `).join('');

    el.addEventListener('click', (e) => {
        const card = e.target.closest('.featured-card');
        if (!card) return;
        openGame(card.dataset.game);
    });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ê²Œì„ ê·¸ë¦¬ë“œ ë Œë”ë§
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderAllGames() {
    let filtered = [...GAMES];

    // ì¹´í…Œê³ ë¦¬ í•„í„°
    if (currentCat === 'top') {
        filtered = filtered.filter(g => g.top);
    } else if (currentCat !== 'all') {
        filtered = filtered.filter(g => g.cat === currentCat);
    }

    // ê²€ìƒ‰ í•„í„°
    if (searchQuery) {
        const q = searchQuery.toLowerCase();
        filtered = filtered.filter(g =>
            g.name.toLowerCase().includes(q) ||
            g.genre.includes(q) ||
            (g.genreEn || '').toLowerCase().includes(q)
        );
    }

    const grid = document.getElementById('gameGrid');
    const count = document.getElementById('gameCount');
    const title = document.getElementById('allGamesTitle');

    count.textContent = `${filtered.length}${isKo ? 'ê°œ' : ' games'}`;

    if (currentCat === 'top') {
        title.textContent = isKo ? 'ğŸ† TOP 5' : 'ğŸ† TOP 5';
    } else if (currentCat !== 'all') {
        const cat = CATEGORIES.find(c => c.id === currentCat);
        title.textContent = `${cat.emoji} ${isKo ? cat.name : cat.nameEn}`;
    } else {
        title.textContent = isKo ? 'ğŸ® ì „ì²´ ê²Œì„' : 'ğŸ® All Games';
    }

    if (filtered.length === 0) {
        grid.innerHTML = `
            <div class="no-results" style="grid-column:1/-1">
                <div class="emoji">ğŸ”</div>
                <div>${isKo ? 'ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤' : 'No games found'}</div>
            </div>
        `;
        return;
    }

    grid.innerHTML = filtered.map(g => `
        <div class="game-card" data-game="${g.id}">
            <div class="game-icon" style="background:${g.top ? 'linear-gradient(135deg, rgba(233,69,96,0.15), rgba(108,92,231,0.15))' : 'rgba(255,255,255,0.03)'}">
                ${g.emoji}
            </div>
            <div class="game-meta">
                <div class="game-name">${g.name}</div>
                <div class="game-genre">${isKo ? g.genre : g.genreEn}</div>
            </div>
        </div>
    `).join('');

    grid.addEventListener('click', (e) => {
        const card = e.target.closest('.game-card');
        if (!card) return;
        openGame(card.dataset.game);
    });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ê²€ìƒ‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setupSearch() {
    const input = document.getElementById('searchInput');
    let timer;
    input.addEventListener('input', () => {
        clearTimeout(timer);
        timer = setTimeout(() => {
            searchQuery = input.value.trim();
            renderAllGames();
        }, 200);
    });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ê²Œì„ ì—´ê¸°
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openGame(gameId) {
    TG.haptic?.('impact', 'light');
    const url = `/games/${gameId}/`;
    
    if (TG.isTelegram?.()) {
        // Telegram ë‚´ë¶€ì—ì„œëŠ” ê°™ì€ WebViewì—ì„œ ì´ë™
        window.location.href = url;
    } else {
        window.location.href = url;
    }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì‹œì‘
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initApp);
} else {
    initApp();
}
</script>
</body>
</html>
