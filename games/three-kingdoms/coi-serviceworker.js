/*! coi-service-worker v0.1.7 - Guido Zuidhof, licensed under MIT */
if(typeof window==='undefined'){self.addEventListener("install",()=>self.skipWaiting()),self.addEventListener("activate",e=>e.waitUntil(self.clients.claim())),self.addEventListener("fetch",e=>{if(e.request.cache==="only-if-cached"&&e.request.mode!=="same-origin")return;e.respondWith(fetch(e.request).then(r=>{if(r.status===0)return r;const h=new Headers(r.headers);h.set("Cross-Origin-Embedder-Policy","require-corp");h.set("Cross-Origin-Opener-Policy","same-origin");return new Response(r.body,{status:r.status,statusText:r.statusText,headers:h})}).catch(err=>console.error(err)))})}else{const r=window.navigator;if(!r.serviceWorker){console.warn("Service workers are not supported.");return}if(window.crossOriginIsolated!==false)return;r.serviceWorker.register(new URL("coi-serviceworker.js",import.meta.url).href).then(reg=>{reg.addEventListener("updatefound",()=>{const w=reg.installing;w.addEventListener("statechange",()=>{if(w.state==="activated")window.location.reload()})})},err=>console.error("COI SW registration failed:",err))}
